# yaml-language-server: $schema=/epics/ibek-defs/ioc.schema.json

ioc_name: "{{  __utils__.get_env('IOC_NAME') }}"

description: auto-generated by https://github.com/epics-containers/builder2ibek

entities:

  - type: epics.EpicsEnvSet
    name: EPICS_TS_MIN_WEST
    value: '0'

  - type: devIocStats.iocAdminSoft
    IOC: '{{ ioc_name | upper }}'

  - type: epics.EpicsCaMaxArrayBytes
    max_bytes: 32000000

  - type: devIocStats.devIocStatsHelper
    __command__: delete
    ioc: BL99P-MO-IOC-01
    name: IOC-STATS

  - type: utility.pingWait
    ip: 10.177.2.1
    name: BRICK1_PING

  - type: pvlogging.PvLogging
    __command__: delete

  - type: pmac.pmacAsynIPPort
    IP: 10.177.2.1:1025
    name: BRICK01PORT

  - type: pmac.GeoBrick
    MovingPoll: 50
    P: BL99P-MO-STEP-01
    name: BRICK01
    pmacAsynPort: BRICK01PORT

  - type: pmac.GeoBrickTrajectoryControl
    NPOINTS: 100000
    PmacController: BRICK01

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 1
    Controller: BRICK01
    DESC: Sample Z
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    M: :Z
    MRES: -2e-05
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.001
    UEIP: No
    VELO: 1.8

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 2
    Controller: BRICK01
    DESC: Sample X
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    M: :X
    MRES: -2e-05
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.001
    UEIP: No
    VELO: 1.8

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 3
    Controller: BRICK01
    DESC: Sample Y
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    M: :Y
    MRES: 2e-05
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.001
    UEIP: No
    VELO: 1.8

  - type: pmac.pmacDisableLimitsCheck
    Axis: 1
    Controller: BRICK01

  - type: pmac.pmacDisableLimitsCheck
    Axis: 2
    Controller: BRICK01

  - type: pmac.pmacDisableLimitsCheck
    Axis: 3
    Controller: BRICK01

  - type: pmac.autohome
    GRP2: F Lens
    P: BL99P-MO-STAGE-01
    PLC: 11
    PmacController: BRICK01

  - type: pmac.autohome
    GRP2: Z
    GRP3: X
    GRP4: Y
    P: BL99P-MO-STAGE-02
    PLC: 12
    PmacController: BRICK01

  - type: pmac.CS
    CS: 1
    PmacController: BRICK01
    name: BRICK1.CS1

  - type: pmac.CS
    CS: 2
    PmacController: BRICK01
    name: BRICK01.CS2

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 7
    Controller: BRICK01.CS2
    DESC: Sample X Lab
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    HOMEVIS: 0
    HOMEVISSTR: This is a virtual motor
    M: :LAB:X
    MRES: 0.0001
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.1
    UEIP: No
    VELO: 17
    is_cs: true

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 8
    Controller: BRICK01.CS2
    DESC: Sample Y Lab
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    HOMEVIS: 0
    HOMEVISSTR: This is a virtual motor
    M: :LAB:Y
    MRES: 0.0001
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.1
    UEIP: No
    VELO: 17
    is_cs: true

  - type: pmac.dls_pmac_asyn_motor
    ACCL: 0.1
    ADDR: 9
    Controller: BRICK01.CS2
    DESC: Sample Z Lab
    DHLM: 7
    DIR: Pos
    DLLM: -7
    EGU: mm
    FOFF: Variable
    HOMEVIS: 0
    HOMEVISSTR: This is a virtual motor
    M: :LAB:Z
    MRES: 0.0001
    P: BL99P-MO-STAGE-02
    PREC: 3
    TWV: 0.1
    UEIP: No
    VELO: 17
    is_cs: true

  - type: pmac.pmacCreateCsGroup
    AxisCount: 3
    Controller: BRICK01
    GroupName: StraightThrough
    GroupNumber: 1

  - type: pmac.pmacCreateCsGroup
    AxisCount: 3
    Controller: BRICK01
    GroupName: J13Kinematics
    GroupNumber: 2

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: Z
    AxisNumber: 1
    Controller: BRICK01
    CoordSysNumber: 1
    GroupNumber: 1

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: X
    AxisNumber: 2
    Controller: BRICK01
    CoordSysNumber: 1
    GroupNumber: 1

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: Y
    AxisNumber: 3
    Controller: BRICK01
    CoordSysNumber: 1
    GroupNumber: 1

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: I
    AxisNumber: 1
    Controller: BRICK01
    CoordSysNumber: 2
    GroupNumber: 2

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: I
    AxisNumber: 2
    Controller: BRICK01
    CoordSysNumber: 2
    GroupNumber: 2

  - type: pmac.pmacCsGroupAddAxis
    AxisDef: I
    AxisNumber: 3
    Controller: BRICK01
    CoordSysNumber: 2
    GroupNumber: 2

  - type: pmac.pmacVariableWrite
    EGU: deg
    P: BL99P-MO-STAGE-01
    PORT: BRICK01
    Q: :WRITETHETA
    VAR: '&2Q21'
    VARIABLE_PREC: 4

  - type: pmac.pmacVariableWrite
    EGU: deg
    P: BL99P-MO-STAGE-01
    PORT: BRICK01
    Q: :WRITEPITCH
    VAR: '&2Q20'
    VARIABLE_PREC: 4

  - type: pmac.pmacVariableWrite
    EGU: deg
    P: BL99P-MO-STAGE-01
    PORT: BRICK01
    Q: :WRITEROLL
    VAR: '&2Q22'
    VARIABLE_PREC: 4

  - type: pmac.pmacMonitorVariables
    Controller: BRICK01
    Variables: P4800 P4805 P4806 P4804 P4905 P4900 P4906 P4904
    name: pVars

  - type: pmac.pmacMonitorVariables
    Controller: BRICK01
    Variables: '&2Q20 &2Q21 &2Q22'
    name: qVars

  - type: positioner.multipositioner
    DESC: Filter Wheel
    MP: :MP
    P: BL99P-MO-STAGE-02
    STRA: Empty
    STRB: Mn 5um
    STRC: Fe (empty)
    STRD: Co 5um
    STRE: Ni 5um
    STRF: Cu 5um
    STRG: Zn 5um
    STRH: Zr (empty)
    STRI: Mo (empty)
    STRJ: Rh (empty)
    STRK: Pd (empty)
    STRL: Ag (empty)
    STRM: Cd 25um
    STRN: W (empty)
    STRO: Pt (empty)
    STRP: User
    name: SAM2.MP

  - type: positioner.motorpositioner
    DESC: Filter Motor
    MP: SAM2.MP
    PREC: 1
    Q: :P
    VALA: 0
    VALB: 0.1
    VALC: 0.2
    VALD: 0.3
    VALE: 0.4
    VALF: 0.5
    VALG: 0.6
    VALH: 0.7
    VALI: 0.8
    VALJ: 0.9
    VALK: 1
    VALL: 1.1
    VALM: 1.2
    VALN: 1.3
    VALO: 1.41
    VALP: 1.5
    motor: SAM2.Z
    name: SAM2.OB1
